{*****************************************************************************

  Delphi Encryption Compendium (DEC Part I)
  Version 5.2, Part I, for Delphi 7 - 2009

  Remarks:          Freeware, Copyright must be included

  Original Author:  (c) 2006 Hagen Reddmann, HaReddmann [at] T-Online [dot] de
  Modifications:    (c) 2008 Arvid Winkelsdorf, info [at] digivendo [dot] de

  Last change:      02. November 2008

 * THIS SOFTWARE IS PROVIDED BY THE AUTHORS ''AS IS'' AND ANY EXPRESS
 * OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
 * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE
 * ARE DISCLAIMED.  IN NO EVENT SHALL THE AUTHORS OR CONTRIBUTORS BE
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
 * BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY,
 * WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE
 * OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

*****************************************************************************}

{$IFDEF THash_Tiger_asm}
procedure THash_Tiger.DoTransform(Buffer: PLongArray);
asm
                push    ebx
                push    esi
                push    edi
                lea     edi, [eax].THash_Tiger.FDigest
                mov     esi, edx
                push    ebp
                mov     ebp, [eax].THash_Tiger.FRounds
                lea     eax, Tiger_Data

                mov     ecx, esp
                add     esp, 0FFFFFF94h
                and     esp, 0FFFFFFC0h
                sub     ebp, 3
                mov     [esp+58h], esi
                mov     [esp+5Ch], edi
                mov     [esp+60h], ebp
                mov     [esp+64h], eax
                mov     [esp+68h], ecx
                mov     eax, [esi]
                mov     ebx, [esi+4]
                mov     [esp], eax
                mov     [esp+4], ebx
                mov     ecx, [esi+8]
                mov     edx, [esi+0Ch]
                mov     [esp+8], ecx
                mov     [esp+0Ch], edx
                mov     eax, [esi+10h]
                mov     ebx, [esi+14h]
                mov     [esp+10h], eax
                mov     [esp+14h], ebx
                mov     ecx, [esi+18h]
                mov     edx, [esi+1Ch]
                mov     [esp+18h], ecx
                mov     [esp+1Ch], edx
                mov     eax, [esi+20h]
                mov     ebx, [esi+24h]
                mov     [esp+20h], eax
                mov     [esp+24h], ebx
                mov     ecx, [esi+28h]
                mov     edx, [esi+2Ch]
                mov     [esp+28h], ecx
                mov     [esp+2Ch], edx
                mov     eax, [esi+30h]
                mov     ebx, [esi+34h]
                mov     [esp+30h], eax
                mov     [esp+34h], ebx
                mov     ecx, [esi+38h]
                mov     edx, [esi+3Ch]
                mov     [esp+38h], ecx
                mov     [esp+3Ch], edx
                mov     eax, [edi]
                mov     ebx, [edi+4]
                mov     [esp+40h], eax
                mov     [esp+44h], ebx
                mov     ecx, [edi+8]
                mov     edx, [edi+0Ch]
                mov     [esp+48h], ecx
                mov     [esp+4Ch], edx
                mov     eax, [edi+10h]
                mov     ebx, [edi+14h]
                mov     [esp+50h], eax
                mov     [esp+54h], ebx
                mov     esi, [esp+64h]
                mov     eax, [esp]
                mov     ebx, [esp+4]
                mov     ecx, [esp+50h]
                mov     edx, [esp+54h]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+50h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+54h], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+40h]
                mov     ebp, [esp+44h]
                sub     edi, ecx
                mov     eax, [esp+50h]
                sbb     ebp, edx
                mov     ebx, [esp+54h]
                mov     [esp+40h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+44h], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+48h]
                mov     ebx, [esp+4Ch]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Eh
                mov     ebp, ebx
                shl     ebx, 2
                mov     edi, eax
                shl     eax, 2
                or      ebx, ecx
                add     eax, edi
                adc     ebx, ebp
                mov     [esp+48h], eax
                mov     [esp+4Ch], ebx
                mov     eax, [esp+8]
                mov     ebx, [esp+0Ch]
                mov     ecx, [esp+40h]
                mov     edx, [esp+44h]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+40h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+44h], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+48h]
                mov     ebp, [esp+4Ch]
                sub     edi, ecx
                mov     eax, [esp+40h]
                sbb     ebp, edx
                mov     ebx, [esp+44h]
                mov     [esp+48h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+4Ch], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+50h]
                mov     ebx, [esp+54h]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Eh
                mov     ebp, ebx
                shl     ebx, 2
                mov     edi, eax
                shl     eax, 2
                or      ebx, ecx
                add     eax, edi
                adc     ebx, ebp
                mov     [esp+50h], eax
                mov     [esp+54h], ebx
                mov     eax, [esp+10h]
                mov     ebx, [esp+14h]
                mov     ecx, [esp+48h]
                mov     edx, [esp+4Ch]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+48h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+4Ch], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+50h]
                mov     ebp, [esp+54h]
                sub     edi, ecx
                mov     eax, [esp+48h]
                sbb     ebp, edx
                mov     ebx, [esp+4Ch]
                mov     [esp+50h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+54h], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+40h]
                mov     ebx, [esp+44h]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Eh
                mov     ebp, ebx
                shl     ebx, 2
                mov     edi, eax
                shl     eax, 2
                or      ebx, ecx
                add     eax, edi
                adc     ebx, ebp
                mov     [esp+40h], eax
                mov     [esp+44h], ebx
                mov     eax, [esp+18h]
                mov     ebx, [esp+1Ch]
                mov     ecx, [esp+50h]
                mov     edx, [esp+54h]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+50h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+54h], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+40h]
                mov     ebp, [esp+44h]
                sub     edi, ecx
                mov     eax, [esp+50h]
                sbb     ebp, edx
                mov     ebx, [esp+54h]
                mov     [esp+40h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+44h], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+48h]
                mov     ebx, [esp+4Ch]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Eh
                mov     ebp, ebx
                shl     ebx, 2
                mov     edi, eax
                shl     eax, 2
                or      ebx, ecx
                add     eax, edi
                adc     ebx, ebp
                mov     [esp+48h], eax
                mov     [esp+4Ch], ebx
                mov     eax, [esp+20h]
                mov     ebx, [esp+24h]
                mov     ecx, [esp+40h]
                mov     edx, [esp+44h]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+40h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+44h], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+48h]
                mov     ebp, [esp+4Ch]
                sub     edi, ecx
                mov     eax, [esp+40h]
                sbb     ebp, edx
                mov     ebx, [esp+44h]
                mov     [esp+48h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+4Ch], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+50h]
                mov     ebx, [esp+54h]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Eh
                mov     ebp, ebx
                shl     ebx, 2
                mov     edi, eax
                shl     eax, 2
                or      ebx, ecx
                add     eax, edi
                adc     ebx, ebp
                mov     [esp+50h], eax
                mov     [esp+54h], ebx
                mov     eax, [esp+28h]
                mov     ebx, [esp+2Ch]
                mov     ecx, [esp+48h]
                mov     edx, [esp+4Ch]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+48h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+4Ch], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+50h]
                mov     ebp, [esp+54h]
                sub     edi, ecx
                mov     eax, [esp+48h]
                sbb     ebp, edx
                mov     ebx, [esp+4Ch]
                mov     [esp+50h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+54h], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+40h]
                mov     ebx, [esp+44h]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Eh
                mov     ebp, ebx
                shl     ebx, 2
                mov     edi, eax
                shl     eax, 2
                or      ebx, ecx
                add     eax, edi
                adc     ebx, ebp
                mov     [esp+40h], eax
                mov     [esp+44h], ebx
                mov     eax, [esp+30h]
                mov     ebx, [esp+34h]
                mov     ecx, [esp+50h]
                mov     edx, [esp+54h]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+50h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+54h], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+40h]
                mov     ebp, [esp+44h]
                sub     edi, ecx
                mov     eax, [esp+50h]
                sbb     ebp, edx
                mov     ebx, [esp+54h]
                mov     [esp+40h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+44h], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+48h]
                mov     ebx, [esp+4Ch]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Eh
                mov     ebp, ebx
                shl     ebx, 2
                mov     edi, eax
                shl     eax, 2
                or      ebx, ecx
                add     eax, edi
                adc     ebx, ebp
                mov     [esp+48h], eax
                mov     [esp+4Ch], ebx
                mov     eax, [esp+38h]
                mov     ebx, [esp+3Ch]
                mov     ecx, [esp+40h]
                mov     edx, [esp+44h]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+40h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+44h], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+48h]
                mov     ebp, [esp+4Ch]
                sub     edi, ecx
                mov     eax, [esp+40h]
                sbb     ebp, edx
                mov     ebx, [esp+44h]
                mov     [esp+48h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+4Ch], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+50h]
                mov     ebx, [esp+54h]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Eh
                mov     ebp, ebx
                shl     ebx, 2
                mov     edi, eax
                shl     eax, 2
                or      ebx, ecx
                add     eax, edi
                adc     ebx, ebp
                mov     [esp+50h], eax
                mov     [esp+54h], ebx
                mov     eax, [esp+38h]
                mov     ebx, [esp+3Ch]
                xor     eax, 0A5A5A5A5h
                xor     ebx, 0A5A5A5A5h
                mov     ecx, [esp]
                mov     edx, [esp+4]
                sub     ecx, eax
                sbb     edx, ebx
                mov     [esp], ecx
                mov     [esp+4], edx
                mov     eax, [esp+8]
                mov     ebx, [esp+0Ch]
                xor     eax, ecx
                xor     ebx, edx
                mov     [esp+8], eax
                mov     edi, eax
                mov     esi, eax
                shr     edi, 0Dh
                xor     eax, 0FFFFFFFFh
                mov     [esp+0Ch], ebx
                mov     ecx, [esp+10h]
                shl     eax, 13h
                mov     ebp, ebx
                shl     ebx, 13h
                mov     edx, [esp+14h]
                add     esi, ecx
                mov     ecx, [esp+20h]
                adc     ebp, edx
                or      edi, ebx
                mov     [esp+10h], esi
                xor     esi, eax
                mov     [esp+14h], ebp
                mov     eax, [esp+18h]
                xor     ebp, 0FFFFFFFFh
                mov     ebx, [esp+1Ch]
                xor     ebp, edi
                sub     eax, esi
                sbb     ebx, ebp
                mov     edx, [esp+24h]
                mov     [esp+18h], eax
                xor     eax, ecx
                mov     [esp+1Ch], ebx
                xor     ebx, edx
                mov     ecx, [esp+28h]
                mov     edx, [esp+2Ch]
                mov     edi, ebx
                mov     ebp, ebx
                mov     [esp+20h], eax
                xor     ebp, 0FFFFFFFFh
                shl     ebx, 9
                add     ecx, eax
                adc     edx, edi
                mov     [esp+24h], edi
                shr     ebp, 17h
                mov     [esp+28h], ecx
                shr     eax, 17h
                xor     ecx, 0FFFFFFFFh
                or      ebx, eax
                mov     [esp+2Ch], edx
                mov     eax, [esp+30h]
                xor     ecx, ebx
                mov     ebx, [esp+34h]
                xor     edx, ebp
                mov     edi, [esp+38h]
                sub     eax, ecx
                mov     ebp, [esp+3Ch]
                mov     [esp+30h], eax
                sbb     ebx, edx
                xor     edi, eax
                xor     ebp, ebx
                mov     [esp+34h], ebx
                mov     eax, [esp]
                mov     ecx, edi
                xor     edi, 0FFFFFFFFh
                mov     ebx, [esp+4]
                shl     edi, 13h
                mov     [esp+38h], ecx
                add     eax, ecx
                mov     [esp+3Ch], ebp
                adc     ebx, ebp
                xor     edi, eax
                shr     ecx, 0Dh
                mov     [esp], eax
                shl     ebp, 13h
                mov     [esp+4], ebx
                mov     esi, [esp+8]
                xor     ebx, 0FFFFFFFFh
                or      ebp, ecx
                mov     edx, [esp+0Ch]
                xor     ebp, ebx
                sub     esi, edi
                mov     eax, [esp+10h]
                mov     ebx, [esp+14h]
                sbb     edx, ebp
                mov     [esp+8], esi
                xor     eax, esi
                mov     [esp+0Ch], edx
                mov     edi, [esp+18h]
                mov     ebp, [esp+1Ch]
                xor     ebx, edx
                mov     [esp+10h], eax
                add     edi, eax
                mov     esi, ebx
                adc     ebp, ebx
                mov     [esp+14h], ebx
                shr     eax, 17h
                mov     ecx, [esp+20h]
                xor     ebx, 0FFFFFFFFh
                mov     edx, [esp+24h]
                shl     esi, 9
                mov     [esp+18h], edi
                or      eax, esi
                xor     edi, 0FFFFFFFFh
                shr     ebx, 17h
                mov     [esp+1Ch], ebp
                xor     eax, edi
                mov     edi, [esp+28h]
                xor     ebx, ebp
                sub     ecx, eax
                mov     ebp, [esp+2Ch]
                mov     [esp+20h], ecx
                sbb     edx, ebx
                xor     edi, ecx
                mov     [esp+24h], edx
                xor     ebp, edx
                mov     eax, [esp+30h]
                mov     ebx, [esp+34h]
                mov     [esp+28h], edi
                add     eax, edi
                mov     [esp+2Ch], ebp
                mov     ecx, [esp+38h]
                adc     ebx, ebp
                mov     edx, [esp+3Ch]
                mov     [esp+30h], eax
                xor     eax, 89ABCDEFh
                mov     [esp+34h], ebx
                xor     ebx, 1234567h
                sub     ecx, eax
                sbb     edx, ebx
                mov     [esp+38h], ecx
                mov     [esp+3Ch], edx
                mov     esi, [esp+64h]
                mov     eax, [esp]
                mov     ebx, [esp+4]
                mov     ecx, [esp+48h]
                mov     edx, [esp+4Ch]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+48h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+4Ch], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+50h]
                mov     ebp, [esp+54h]
                sub     edi, ecx
                mov     eax, [esp+48h]
                sbb     ebp, edx
                mov     ebx, [esp+4Ch]
                mov     [esp+50h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+54h], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+40h]
                mov     ebx, [esp+44h]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Dh
                mov     ebp, ebx
                shl     ebx, 3
                mov     edi, eax
                shl     eax, 3
                or      ebx, ecx
                sub     eax, edi
                sbb     ebx, ebp
                mov     [esp+40h], eax
                mov     [esp+44h], ebx
                mov     eax, [esp+8]
                mov     ebx, [esp+0Ch]
                mov     ecx, [esp+50h]
                mov     edx, [esp+54h]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+50h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+54h], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+40h]
                mov     ebp, [esp+44h]
                sub     edi, ecx
                mov     eax, [esp+50h]
                sbb     ebp, edx
                mov     ebx, [esp+54h]
                mov     [esp+40h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+44h], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+48h]
                mov     ebx, [esp+4Ch]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Dh
                mov     ebp, ebx
                shl     ebx, 3
                mov     edi, eax
                shl     eax, 3
                or      ebx, ecx
                sub     eax, edi
                sbb     ebx, ebp
                mov     [esp+48h], eax
                mov     [esp+4Ch], ebx
                mov     eax, [esp+10h]
                mov     ebx, [esp+14h]
                mov     ecx, [esp+40h]
                mov     edx, [esp+44h]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+40h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+44h], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+48h]
                mov     ebp, [esp+4Ch]
                sub     edi, ecx
                mov     eax, [esp+40h]
                sbb     ebp, edx
                mov     ebx, [esp+44h]
                mov     [esp+48h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+4Ch], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+50h]
                mov     ebx, [esp+54h]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Dh
                mov     ebp, ebx
                shl     ebx, 3
                mov     edi, eax
                shl     eax, 3
                or      ebx, ecx
                sub     eax, edi
                sbb     ebx, ebp
                mov     [esp+50h], eax
                mov     [esp+54h], ebx
                mov     eax, [esp+18h]
                mov     ebx, [esp+1Ch]
                mov     ecx, [esp+48h]
                mov     edx, [esp+4Ch]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+48h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+4Ch], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+50h]
                mov     ebp, [esp+54h]
                sub     edi, ecx
                mov     eax, [esp+48h]
                sbb     ebp, edx
                mov     ebx, [esp+4Ch]
                mov     [esp+50h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+54h], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+40h]
                mov     ebx, [esp+44h]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Dh
                mov     ebp, ebx
                shl     ebx, 3
                mov     edi, eax
                shl     eax, 3
                or      ebx, ecx
                sub     eax, edi
                sbb     ebx, ebp
                mov     [esp+40h], eax
                mov     [esp+44h], ebx
                mov     eax, [esp+20h]
                mov     ebx, [esp+24h]
                mov     ecx, [esp+50h]
                mov     edx, [esp+54h]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+50h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+54h], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+40h]
                mov     ebp, [esp+44h]
                sub     edi, ecx
                mov     eax, [esp+50h]
                sbb     ebp, edx
                mov     ebx, [esp+54h]
                mov     [esp+40h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+44h], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+48h]
                mov     ebx, [esp+4Ch]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Dh
                mov     ebp, ebx
                shl     ebx, 3
                mov     edi, eax
                shl     eax, 3
                or      ebx, ecx
                sub     eax, edi
                sbb     ebx, ebp
                mov     [esp+48h], eax
                mov     [esp+4Ch], ebx
                mov     eax, [esp+28h]
                mov     ebx, [esp+2Ch]
                mov     ecx, [esp+40h]
                mov     edx, [esp+44h]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+40h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+44h], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+48h]
                mov     ebp, [esp+4Ch]
                sub     edi, ecx
                mov     eax, [esp+40h]
                sbb     ebp, edx
                mov     ebx, [esp+44h]
                mov     [esp+48h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+4Ch], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+50h]
                mov     ebx, [esp+54h]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Dh
                mov     ebp, ebx
                shl     ebx, 3
                mov     edi, eax
                shl     eax, 3
                or      ebx, ecx
                sub     eax, edi
                sbb     ebx, ebp
                mov     [esp+50h], eax
                mov     [esp+54h], ebx
                mov     eax, [esp+30h]
                mov     ebx, [esp+34h]
                mov     ecx, [esp+48h]
                mov     edx, [esp+4Ch]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+48h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+4Ch], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+50h]
                mov     ebp, [esp+54h]
                sub     edi, ecx
                mov     eax, [esp+48h]
                sbb     ebp, edx
                mov     ebx, [esp+4Ch]
                mov     [esp+50h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+54h], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+40h]
                mov     ebx, [esp+44h]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Dh
                mov     ebp, ebx
                shl     ebx, 3
                mov     edi, eax
                shl     eax, 3
                or      ebx, ecx
                sub     eax, edi
                sbb     ebx, ebp
                mov     [esp+40h], eax
                mov     [esp+44h], ebx
                mov     eax, [esp+38h]
                mov     ebx, [esp+3Ch]
                mov     ecx, [esp+50h]
                mov     edx, [esp+54h]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+50h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+54h], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+40h]
                mov     ebp, [esp+44h]
                sub     edi, ecx
                mov     eax, [esp+50h]
                sbb     ebp, edx
                mov     ebx, [esp+54h]
                mov     [esp+40h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+44h], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+48h]
                mov     ebx, [esp+4Ch]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Dh
                mov     ebp, ebx
                shl     ebx, 3
                mov     edi, eax
                shl     eax, 3
                or      ebx, ecx
                sub     eax, edi
                sbb     ebx, ebp
                mov     [esp+48h], eax
                mov     [esp+4Ch], ebx
                mov     eax, [esp+38h]
                mov     ebx, [esp+3Ch]
                xor     eax, 0A5A5A5A5h
                xor     ebx, 0A5A5A5A5h
                mov     ecx, [esp]
                mov     edx, [esp+4]
                sub     ecx, eax
                sbb     edx, ebx
                mov     [esp], ecx
                mov     [esp+4], edx
                mov     eax, [esp+8]
                mov     ebx, [esp+0Ch]
                xor     eax, ecx
                xor     ebx, edx
                mov     [esp+8], eax
                mov     edi, eax
                mov     esi, eax
                shr     edi, 0Dh
                xor     eax, 0FFFFFFFFh
                mov     [esp+0Ch], ebx
                mov     ecx, [esp+10h]
                shl     eax, 13h
                mov     ebp, ebx
                shl     ebx, 13h
                mov     edx, [esp+14h]
                add     esi, ecx
                mov     ecx, [esp+20h]
                adc     ebp, edx
                or      edi, ebx
                mov     [esp+10h], esi
                xor     esi, eax
                mov     [esp+14h], ebp
                mov     eax, [esp+18h]
                xor     ebp, 0FFFFFFFFh
                mov     ebx, [esp+1Ch]
                xor     ebp, edi
                sub     eax, esi
                sbb     ebx, ebp
                mov     edx, [esp+24h]
                mov     [esp+18h], eax
                xor     eax, ecx
                mov     [esp+1Ch], ebx
                xor     ebx, edx
                mov     ecx, [esp+28h]
                mov     edx, [esp+2Ch]
                mov     edi, ebx
                mov     ebp, ebx
                mov     [esp+20h], eax
                xor     ebp, 0FFFFFFFFh
                shl     ebx, 9
                add     ecx, eax
                adc     edx, edi
                mov     [esp+24h], edi
                shr     ebp, 17h
                mov     [esp+28h], ecx
                shr     eax, 17h
                xor     ecx, 0FFFFFFFFh
                or      ebx, eax
                mov     [esp+2Ch], edx
                mov     eax, [esp+30h]
                xor     ecx, ebx
                mov     ebx, [esp+34h]
                xor     edx, ebp
                mov     edi, [esp+38h]
                sub     eax, ecx
                mov     ebp, [esp+3Ch]
                mov     [esp+30h], eax
                sbb     ebx, edx
                xor     edi, eax
                xor     ebp, ebx
                mov     [esp+34h], ebx
                mov     eax, [esp]
                mov     ecx, edi
                xor     edi, 0FFFFFFFFh
                mov     ebx, [esp+4]
                shl     edi, 13h
                mov     [esp+38h], ecx
                add     eax, ecx
                mov     [esp+3Ch], ebp
                adc     ebx, ebp
                xor     edi, eax
                shr     ecx, 0Dh
                mov     [esp], eax
                shl     ebp, 13h
                mov     [esp+4], ebx
                mov     esi, [esp+8]
                xor     ebx, 0FFFFFFFFh
                or      ebp, ecx
                mov     edx, [esp+0Ch]
                xor     ebp, ebx
                sub     esi, edi
                mov     eax, [esp+10h]
                mov     ebx, [esp+14h]
                sbb     edx, ebp
                mov     [esp+8], esi
                xor     eax, esi
                mov     [esp+0Ch], edx
                mov     edi, [esp+18h]
                mov     ebp, [esp+1Ch]
                xor     ebx, edx
                mov     [esp+10h], eax
                add     edi, eax
                mov     esi, ebx
                adc     ebp, ebx
                mov     [esp+14h], ebx
                shr     eax, 17h
                mov     ecx, [esp+20h]
                xor     ebx, 0FFFFFFFFh
                mov     edx, [esp+24h]
                shl     esi, 9
                mov     [esp+18h], edi
                or      eax, esi
                xor     edi, 0FFFFFFFFh
                shr     ebx, 17h
                mov     [esp+1Ch], ebp
                xor     eax, edi
                mov     edi, [esp+28h]
                xor     ebx, ebp
                sub     ecx, eax
                mov     ebp, [esp+2Ch]
                mov     [esp+20h], ecx
                sbb     edx, ebx
                xor     edi, ecx
                mov     [esp+24h], edx
                xor     ebp, edx
                mov     eax, [esp+30h]
                mov     ebx, [esp+34h]
                mov     [esp+28h], edi
                add     eax, edi
                mov     [esp+2Ch], ebp
                mov     ecx, [esp+38h]
                adc     ebx, ebp
                mov     edx, [esp+3Ch]
                mov     [esp+30h], eax
                xor     eax, 89ABCDEFh
                mov     [esp+34h], ebx
                xor     ebx, 1234567h
                sub     ecx, eax
                sbb     edx, ebx
                mov     [esp+38h], ecx
                mov     [esp+3Ch], edx

@_pass_loop:
                mov     esi, [esp+64h]
                mov     eax, [esp]
                mov     ebx, [esp+4]
                mov     ecx, [esp+40h]
                mov     edx, [esp+44h]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+40h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+44h], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+48h]
                mov     ebp, [esp+4Ch]
                sub     edi, ecx
                mov     eax, [esp+40h]
                sbb     ebp, edx
                mov     ebx, [esp+44h]
                mov     [esp+48h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+4Ch], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+50h]
                mov     ebx, [esp+54h]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Dh
                mov     ebp, ebx
                shl     ebx, 3
                mov     edi, eax
                shl     eax, 3
                or      ebx, ecx
                add     eax, edi
                adc     ebx, ebp
                mov     [esp+50h], eax
                mov     [esp+54h], ebx
                mov     eax, [esp+8]
                mov     ebx, [esp+0Ch]
                mov     ecx, [esp+48h]
                mov     edx, [esp+4Ch]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+48h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+4Ch], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+50h]
                mov     ebp, [esp+54h]
                sub     edi, ecx
                mov     eax, [esp+48h]
                sbb     ebp, edx
                mov     ebx, [esp+4Ch]
                mov     [esp+50h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+54h], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+40h]
                mov     ebx, [esp+44h]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Dh
                mov     ebp, ebx
                shl     ebx, 3
                mov     edi, eax
                shl     eax, 3
                or      ebx, ecx
                add     eax, edi
                adc     ebx, ebp
                mov     [esp+40h], eax
                mov     [esp+44h], ebx
                mov     eax, [esp+10h]
                mov     ebx, [esp+14h]
                mov     ecx, [esp+50h]
                mov     edx, [esp+54h]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+50h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+54h], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+40h]
                mov     ebp, [esp+44h]
                sub     edi, ecx
                mov     eax, [esp+50h]
                sbb     ebp, edx
                mov     ebx, [esp+54h]
                mov     [esp+40h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+44h], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+48h]
                mov     ebx, [esp+4Ch]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Dh
                mov     ebp, ebx
                shl     ebx, 3
                mov     edi, eax
                shl     eax, 3
                or      ebx, ecx
                add     eax, edi
                adc     ebx, ebp
                mov     [esp+48h], eax
                mov     [esp+4Ch], ebx
                mov     eax, [esp+18h]
                mov     ebx, [esp+1Ch]
                mov     ecx, [esp+40h]
                mov     edx, [esp+44h]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+40h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+44h], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+48h]
                mov     ebp, [esp+4Ch]
                sub     edi, ecx
                mov     eax, [esp+40h]
                sbb     ebp, edx
                mov     ebx, [esp+44h]
                mov     [esp+48h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+4Ch], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+50h]
                mov     ebx, [esp+54h]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Dh
                mov     ebp, ebx
                shl     ebx, 3
                mov     edi, eax
                shl     eax, 3
                or      ebx, ecx
                add     eax, edi
                adc     ebx, ebp
                mov     [esp+50h], eax
                mov     [esp+54h], ebx
                mov     eax, [esp+20h]
                mov     ebx, [esp+24h]
                mov     ecx, [esp+48h]
                mov     edx, [esp+4Ch]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+48h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+4Ch], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+50h]
                mov     ebp, [esp+54h]
                sub     edi, ecx
                mov     eax, [esp+48h]
                sbb     ebp, edx
                mov     ebx, [esp+4Ch]
                mov     [esp+50h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+54h], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+40h]
                mov     ebx, [esp+44h]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Dh
                mov     ebp, ebx
                shl     ebx, 3
                mov     edi, eax
                shl     eax, 3
                or      ebx, ecx
                add     eax, edi
                adc     ebx, ebp
                mov     [esp+40h], eax
                mov     [esp+44h], ebx
                mov     eax, [esp+28h]
                mov     ebx, [esp+2Ch]
                mov     ecx, [esp+50h]
                mov     edx, [esp+54h]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+50h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+54h], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+40h]
                mov     ebp, [esp+44h]
                sub     edi, ecx
                mov     eax, [esp+50h]
                sbb     ebp, edx
                mov     ebx, [esp+54h]
                mov     [esp+40h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+44h], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+48h]
                mov     ebx, [esp+4Ch]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Dh
                mov     ebp, ebx
                shl     ebx, 3
                mov     edi, eax
                shl     eax, 3
                or      ebx, ecx
                add     eax, edi
                adc     ebx, ebp
                mov     [esp+48h], eax
                mov     [esp+4Ch], ebx
                mov     eax, [esp+30h]
                mov     ebx, [esp+34h]
                mov     ecx, [esp+40h]
                mov     edx, [esp+44h]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+40h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+44h], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+48h]
                mov     ebp, [esp+4Ch]
                sub     edi, ecx
                mov     eax, [esp+40h]
                sbb     ebp, edx
                mov     ebx, [esp+44h]
                mov     [esp+48h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+4Ch], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+50h]
                mov     ebx, [esp+54h]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Dh
                mov     ebp, ebx
                shl     ebx, 3
                mov     edi, eax
                shl     eax, 3
                or      ebx, ecx
                add     eax, edi
                adc     ebx, ebp
                mov     [esp+50h], eax
                mov     [esp+54h], ebx
                mov     eax, [esp+38h]
                mov     ebx, [esp+3Ch]
                mov     ecx, [esp+48h]
                mov     edx, [esp+4Ch]
                xor     eax, ecx
                xor     ebx, edx
                mov     edi, eax
                mov     [esp+48h], eax
                shr     eax, 0Dh
                mov     ebp, ebx
                and     edi, 0FFh
                mov     [esp+4Ch], ebx
                shl     edi, 3
                and     ebp, 0FFh
                shr     ebx, 0Dh
                and     eax, 7F8h
                shl     ebp, 3
                mov     ecx, [esi+edi]
                mov     edx, [esi+edi+4]
                xor     ecx, [esi+eax+800h]
                xor     edx, [esi+eax+804h]
                and     ebx, 7F8h
                xor     ecx, [esi+ebp+1000h]
                xor     edx, [esi+ebp+1004h]
                xor     ecx, [esi+ebx+1800h]
                xor     edx, [esi+ebx+1804h]
                mov     edi, [esp+50h]
                mov     ebp, [esp+54h]
                sub     edi, ecx
                mov     eax, [esp+48h]
                sbb     ebp, edx
                mov     ebx, [esp+4Ch]
                mov     [esp+50h], edi
                mov     edi, eax
                shr     eax, 5
                mov     [esp+54h], ebp
                shr     edi, 15h
                mov     ebp, ebx
                shr     ebx, 5
                and     eax, 7F8h
                shr     ebp, 15h
                and     edi, 7F8h
                and     ebx, 7F8h
                mov     ecx, [esi+eax+1800h]
                mov     edx, [esi+eax+1804h]
                xor     ecx, [esi+edi+1000h]
                and     ebp, 7F8h
                xor     edx, [esi+edi+1004h]
                xor     ecx, [esi+ebx+800h]
                xor     edx, [esi+ebx+804h]
                xor     ecx, [esi+ebp]
                xor     edx, [esi+ebp+4]
                mov     eax, [esp+40h]
                mov     ebx, [esp+44h]
                add     eax, ecx
                adc     ebx, edx
                mov     ecx, eax
                shr     ecx, 1Dh
                mov     ebp, ebx
                shl     ebx, 3
                mov     edi, eax
                shl     eax, 3
                or      ebx, ecx
                add     eax, edi
                adc     ebx, ebp
                mov     [esp+40h], eax
                mov     [esp+44h], ebx
                mov     esi, [esp+60h]
                test    esi, esi
                jnz     @_yet_more_cycles 
                jmp     @_pass_loop_end

@_yet_more_cycles:

                dec     esi
                mov     [esp+60h], esi
                mov     eax, [esp+38h]
                mov     ebx, [esp+3Ch]
                xor     eax, 0A5A5A5A5h
                xor     ebx, 0A5A5A5A5h
                mov     ecx, [esp]
                mov     edx, [esp+4]
                sub     ecx, eax
                sbb     edx, ebx
                mov     [esp], ecx
                mov     [esp+4], edx
                mov     eax, [esp+8]
                mov     ebx, [esp+0Ch]
                xor     eax, ecx
                xor     ebx, edx
                mov     [esp+8], eax
                mov     edi, eax
                mov     esi, eax
                shr     edi, 0Dh
                xor     eax, 0FFFFFFFFh
                mov     [esp+0Ch], ebx
                mov     ecx, [esp+10h]
                shl     eax, 13h
                mov     ebp, ebx
                shl     ebx, 13h
                mov     edx, [esp+14h]
                add     esi, ecx
                mov     ecx, [esp+20h]
                adc     ebp, edx
                or      edi, ebx
                mov     [esp+10h], esi
                xor     esi, eax
                mov     [esp+14h], ebp
                mov     eax, [esp+18h]
                xor     ebp, 0FFFFFFFFh
                mov     ebx, [esp+1Ch]
                xor     ebp, edi
                sub     eax, esi
                sbb     ebx, ebp
                mov     edx, [esp+24h]
                mov     [esp+18h], eax
                xor     eax, ecx
                mov     [esp+1Ch], ebx
                xor     ebx, edx
                mov     ecx, [esp+28h]
                mov     edx, [esp+2Ch]
                mov     edi, ebx
                mov     ebp, ebx
                mov     [esp+20h], eax
                xor     ebp, 0FFFFFFFFh
                shl     ebx, 9
                add     ecx, eax
                adc     edx, edi
                mov     [esp+24h], edi
                shr     ebp, 17h
                mov     [esp+28h], ecx
                shr     eax, 17h
                xor     ecx, 0FFFFFFFFh
                or      ebx, eax
                mov     [esp+2Ch], edx
                mov     eax, [esp+30h]
                xor     ecx, ebx
                mov     ebx, [esp+34h]
                xor     edx, ebp
                mov     edi, [esp+38h]
                sub     eax, ecx
                mov     ebp, [esp+3Ch]
                mov     [esp+30h], eax
                sbb     ebx, edx
                xor     edi, eax
                xor     ebp, ebx
                mov     [esp+34h], ebx
                mov     eax, [esp]
                mov     ecx, edi
                xor     edi, 0FFFFFFFFh
                mov     ebx, [esp+4]
                shl     edi, 13h
                mov     [esp+38h], ecx
                add     eax, ecx
                mov     [esp+3Ch], ebp
                adc     ebx, ebp
                xor     edi, eax
                shr     ecx, 0Dh
                mov     [esp], eax
                shl     ebp, 13h
                mov     [esp+4], ebx
                mov     esi, [esp+8]
                xor     ebx, 0FFFFFFFFh
                or      ebp, ecx
                mov     edx, [esp+0Ch]
                xor     ebp, ebx
                sub     esi, edi
                mov     eax, [esp+10h]
                mov     ebx, [esp+14h]
                sbb     edx, ebp
                mov     [esp+8], esi
                xor     eax, esi
                mov     [esp+0Ch], edx
                mov     edi, [esp+18h]
                mov     ebp, [esp+1Ch]
                xor     ebx, edx
                mov     [esp+10h], eax
                add     edi, eax
                mov     esi, ebx
                adc     ebp, ebx
                mov     [esp+14h], ebx
                shr     eax, 17h
                mov     ecx, [esp+20h]
                xor     ebx, 0FFFFFFFFh
                mov     edx, [esp+24h]
                shl     esi, 9
                mov     [esp+18h], edi
                or      eax, esi
                xor     edi, 0FFFFFFFFh
                shr     ebx, 17h
                mov     [esp+1Ch], ebp
                xor     eax, edi
                mov     edi, [esp+28h]
                xor     ebx, ebp
                sub     ecx, eax
                mov     ebp, [esp+2Ch]
                mov     [esp+20h], ecx
                sbb     edx, ebx
                xor     edi, ecx
                mov     [esp+24h], edx
                xor     ebp, edx
                mov     eax, [esp+30h]
                mov     ebx, [esp+34h]
                mov     [esp+28h], edi
                add     eax, edi
                mov     [esp+2Ch], ebp
                mov     ecx, [esp+38h]
                adc     ebx, ebp
                mov     edx, [esp+3Ch]
                mov     [esp+30h], eax
                xor     eax, 89ABCDEFh
                mov     [esp+34h], ebx
                xor     ebx, 1234567h
                sub     ecx, eax
                sbb     edx, ebx
                mov     [esp+38h], ecx
                mov     [esp+3Ch], edx
                mov     eax, [esp+40h]
                mov     ebx, [esp+44h]
                mov     ecx, [esp+48h]
                mov     edx, [esp+4Ch]
                mov     [esp+48h], eax
                mov     [esp+4Ch], ebx
                mov     edi, [esp+50h]
                mov     ebp, [esp+54h]
                mov     [esp+50h], ecx
                mov     [esp+54h], edx
                mov     [esp+40h], edi
                mov     [esp+44h], ebp
                jmp     @_pass_loop

@_pass_loop_end:
                mov     esi, [esp+5Ch]
                mov     eax, [esp+40h]
                mov     ebx, [esp+44h]
                mov     edi, [esp+48h]
                mov     ebp, [esp+4Ch]
                mov     ecx, [esi]
                mov     edx, [esi+4]
                xor     eax, ecx
                xor     ebx, edx
                mov     [esi], eax
                mov     ecx, [esi+8]
                mov     edx, [esi+0Ch]
                mov     [esi+4], ebx
                sub     edi, ecx
                mov     ecx, [esi+10h]
                mov     [esi+8], edi
                sbb     ebp, edx
                mov     edx, [esi+14h]
                mov     [esi+0Ch], ebp
                mov     eax, [esp+50h]
                mov     ebx, [esp+54h]
                add     ecx, eax
                adc     edx, ebx
                mov     [esi+10h], ecx
                mov     [esi+14h], edx
                mov     ebp, [esp+68h]
                mov     esp, ebp
                pop     ebp
                pop     edi
                pop     esi
                pop     ebx
end;
{$ENDIF}
